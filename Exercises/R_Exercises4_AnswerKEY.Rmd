---
title: "R Exercises Session 4"
author: "Introduction to R for Data Management and Analysis"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Note**: Use `Ctrl (Command) + Alt (Option) + I` or go to `Code` > `Insert Chunk` (from the menu) to insert a code block "chunk".

## Exercises

1. Create a histogram (using the `hist` fuction) of `mpg` from the `mtcars`
dataset. Set the _x axis_ label to "Miles per Gallon (mpg)" using the `xlab`
argument.

```{r}
hist(mtcars[["mpg"]], xlab = "Miles per Gallon (mpg)")
```

2. Use the `mtcars` dataset to draw a scatterplot of weight `wt` and
displacement `disp`. The `plot` function takes two vectors as input. Provide
the `wt` and `disp` vectors as input to the `plot` function.

```{r}
plot(mtcars$wt, mtcars$disp, xlab = "Weight", ylab = "Displacement")
# optionally you can draw a regression line
fitLine <- lm(disp ~ wt, data = mtcars)
abline(fitLine, col = "darkblue", lwd = 3)
```

3. Install the `psych` package using `install.packages` with the package name
"psych" character input. Use the `pairs.panels` function on the `mtcars`
dataset. What are some variables that are highly correlated (> |.80|)? What
does it tell you about the relationship between displacement (`disp`) and the
number of cylinders (`cyl`)?

```{r}
## install.packages("psych")
library(psych)
pairs.panels(mtcars)
```

The relationship between miles per gallon (`mpg`) and cylinder (`cyl`) is
strong and negative. As miles per gallon rating goes up, number of cylinders
goes down. The relationship between the number of cylinders and displacement
(`disp`) is strong and positive. The displacement of fuel is higher when the
number of cylinders is greater.

4. Based on the previous lecture's example, group the mtcars dataset by
the `vs` variable and obtain the mean displacement (`disp`) for each of
the categories in the `vs` variable (v-shaped vs. straight). What can you
say about the design of engines in terms of the displacement of fuel in cubic
inches?

```{r}
# option 1
tapply(X = mtcars$disp, INDEX = mtcars$vs, FUN = mean)

# option 2
aggregate(disp ~ vs, data = mtcars, FUN = mean)

# option 3
library(dplyr)
group_by(mtcars, vs) %>%
    summarize(mean_disp = mean(disp))
```

On average, v-shaped engines displace more fuel than straight engines.


5. Use a formula and the `boxplot` function to show the distribution of
`Petal.Length` by `Species` in the `iris` dataset.


```{r}
data("iris")
boxplot(Petal.Length ~ Species, data = iris)
```

## Extra credit

6. Select 3 **numeric** variables by subsetting the mtcars dataset. See the
`?mtcars` for more information about the columns. Save the `data.frame` to an
object / variable. Create correlation matrix (using `cor()`) with the
**numeric** observations in the subset. Find the correlations that are greater
than the absolute (`abs()`) value of `.80` (with a logical vector). What pairs
of variables are highly correlated? Show your code.

```{r}
mtcars2 <- mtcars[, c("mpg", "wt", "hp")]
mycorrel <- abs(cor(mtcars2))

mycorrel > 0.8 & mycorrel!= 1
```

