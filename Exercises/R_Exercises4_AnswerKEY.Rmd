---
title: "R Exercises Session 4"
author: "Introduction to R for Data Management and Analysis"
date: "June 14, 2016"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Note**: Use `Ctrl (Command) + Alt (Option) + I` or go to `Code` > `Insert Chunk` (from the menu) to insert a code block "chunk". 

## Exercises

1. Create a histogram of the `mtcars` dataset with the `mpg` variable. Change the _x axis_ label to "Miles per Gallon (mpg)".

```{r}
hist(mtcars[["mpg"]], xlab = "Miles per Gallon (mpg)")
```

2. Use the `mtcars` dataset to draw a scatterplot of weight `wt` and displacement `disp`. Draw a fit line using the `lm` function and formula notation. 

```{r}
plot(mtcars$wt, mtcars$disp, xlab = "Weight", ylab = "Displacement")
fitLine <- lm(mtcars$disp ~ mtcars$wt)
abline(fitLine, col = "darkblue", lwd = 3)
```

3. Run the "pairs.panels" function from the `psych` package on the `mtcars` dataset. What variables are highly correlated (> |.80|)? What does it tell you about the displacement variable and the number of cylinders? 

```{r}
## install.packages("psych")
library(psych)
pairs.panels(mtcars)
```

The relationship between miles per gallon (`mpg`) and cylinder (`cyl`) is strong and negative. As miles per gallon rating goes up, number of cylinders goes down. The relationship between the number of cylinders and displacement (`disp`) is strong and positive. The displacement of fuel is higher when the number of cylinders is greater. 

4. Create any 4 plots and put them in one single output device using the `par` function. Can you reorder the plots so that you get 4 in one column? Show your code. 

```{r}
## optional to use library(rafalib)
rafalib::mypar()
par(mfrow = c(4, 1))

plot(mtcars[, "mpg"], mtcars[, "hp"])
plot(mtcars[, "wt"], mtcars[, "disp"])
boxplot(weight ~ feed, data = chickwts)
boxplot(len ~ supp, data = ToothGrowth)
```

5. Use the `iris` dataset to draw boxplots of `Petal.Length` for each of the species. Show your code. 

```{r}
par(mfrow = c(1,1))
boxplot(Petal.Length ~ Species, data = iris)
```

## Extra credit

6. Create correlation matrix using only **numeric** observations in the `mtcars` dataset. Find the correlations that are greater than the absolute value of `.80`. What pairs of variables are highly correlated? Show your code. 

```{r}
# Remove cylinders variable from the data as it is categorical (conceptually)
categorical <- !(names(mtcars) %in% c("cyl", "vs", "am", "gear", "carb"))
mtcars2 <- mtcars[, categorical]
mycorrel <- abs(cor(mtcars2))

mycorrel > 0.8 & mycorrel!= 1
```

The following 3 variable pairs are highly correlated:

1. `mpg` and `wt` 
2. `disp` and `wt`
3. `mpg` and `disp`




